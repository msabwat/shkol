{
  "name": "Handwritten JPEG OCR and Error Correction",
  "nodes": [
    {
      "parameters": {
        "formTitle": "–ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∏–∫—Ç–∞–Ω—Ç–∞ –ø–æ —Ä—É—Å—Å–∫–æ–º—É —è–∑—ã–∫—É",
        "formDescription": "–ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—é –¥–∏–∫—Ç–∞–Ω—Ç–∞ —É—á–µ–Ω–∏–∫–∞ 5 –∫–ª–∞—Å—Å–∞ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏",
        "formFields": {
          "values": [
            {
              "fieldLabel": "image",
              "fieldType": "file",
              "multipleFiles": false,
              "acceptFileTypes": "image/jpeg,image/jpg"
            }
          ]
        },
        "options": {
          "appendAttribution": false,
          "buttonLabel": "Process Image"
        }
      },
      "id": "717d0dba-9221-4417-afc1-e8ed2d5b06db",
      "name": "Upload JPEG Form",
      "type": "n8n-nodes-base.formTrigger",
      "typeVersion": 2.3,
      "position": [
        7200,
        1120
      ],
      "webhookId": "080c0dec-f04e-4b31-b211-2cdf858e4791"
    },
    {
      "parameters": {
        "text": "={{ $('Extract Text with Gemini Vision').item.json.content.parts[0].text }}",
        "attributes": {
          "attributes": [
            {
              "name": "grade",
              "description": "–û—Ü–µ–Ω–∫–∞ –∑–∞ –¥–∏–∫—Ç–∞–Ω—Ç (5, 4, 3, –∏–ª–∏ 2)"
            },
            {
              "name": "supportiveComment",
              "description": "–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—â–∏–π –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –¥–ª—è —É—á–µ–Ω–∏–∫–∞ (2-3 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è)"
            },
            {
              "name": "orthographicErrors",
              "type": "number",
              "description": "–û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Ä—Ñ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫"
            },
            {
              "name": "punctuationErrors",
              "type": "number",
              "description": "–û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—É–Ω–∫—Ç—É–∞—Ü–∏–æ–Ω–Ω—ã—Ö –æ—à–∏–±–æ–∫"
            },
            {
              "name": "areasForImprovement",
              "description": "–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–ª—è —Ä–∞–±–æ—Ç—ã: 1-2 –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –ø—Ä–∞–≤–∏–ª–∞ –∏–ª–∏ —Ç–µ–º—ã –¥–ª—è –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏—è"
            },
            {
              "name": "originalText",
              "description": "–û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π —Ç–µ–∫—Å—Ç –¥–∏–∫—Ç–∞–Ω—Ç–∞, —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–Ω—ã–π –∏–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è"
            }
          ]
        },
        "options": {
          "systemPromptTemplate": "ROLE: Sensitive Russian Language Teacher (5th Grade). Assess dictation strictly by norms.\n\nTONE: Supportive, motivating, focused on growth.\n\nGRADING RUBRIC:\n\nGrade 5: 0‚Äì1 spelling errors (non-gross), 0‚Äì1 punctuation errors (near-perfect)\nGrade 4: ‚â§2 spelling errors, ‚â§3 punctuation errors (good mastery)\nGrade 3: 3‚Äì5 spelling errors, 4‚Äì5 punctuation errors (basic grasp)\nGrade 2: >5‚Äì6 spelling errors, >5 punctuation errors (weak mastery)\n\nRULES:\n- Repeated Error: If the same error repeats multiple times, count as 1 spelling error\n- Weight: 2‚Äì3 punctuation errors ‚âà 1 spelling error for final grade consideration\n- Non-gross errors (e.g., missing hyphen, typo) count as punctuation errors\n\nAnalyze the dictation text, count errors according to the rules, and fill all structured response fields."
        }
      },
      "id": "e312fe73-09fc-4780-a7a8-3602ea38be42",
      "name": "Check and Correct Mistakes",
      "type": "@n8n/n8n-nodes-langchain.informationExtractor",
      "typeVersion": 1.2,
      "position": [
        7648,
        1120
      ]
    },
    {
      "parameters": {
        "model": "codestral-2411-rc5",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatMistralCloud",
      "typeVersion": 1,
      "position": [
        7728,
        1344
      ],
      "id": "0a66134a-82ba-41c2-bfbc-d8116999c54a",
      "name": "Mistral Cloud Chat Model",
      "credentials": {
        "mistralCloudApi": {
          "id": "KofbMHmcXTgW3Y2y",
          "name": "Mistral Cloud account"
        }
      }
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "id-1",
              "name": "message",
              "value": "=üìù –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–∏–∫—Ç–∞–Ω—Ç–∞\n\nüéØ –û—Ü–µ–Ω–∫–∞: {{ $json.output.grade }}\n\nüí¨ {{ $json.output.supportiveComment }}\n\nüìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ—à–∏–±–æ–∫:\n‚Ä¢ –û—Ä—Ñ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏: {{ $json.output.orthographicErrors }}\n‚Ä¢ –ü—É–Ω–∫—Ç—É–∞—Ü–∏–æ–Ω–Ω—ã–µ –æ—à–∏–±–∫–∏: {{ $json.output.punctuationErrors }}\n\nüìö –ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–ª—è —Ä–∞–±–æ—Ç—ã:\n{{ $json.output.areasForImprovement }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "id": "254b7b7c-33d0-4784-a4fb-55649af3d77c",
      "name": "Format Telegram Message",
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        8000,
        1120
      ]
    },
    {
      "parameters": {
        "chatId": "5765411120",
        "text": "={{ $json.message }}",
        "additionalFields": {
          "parse_mode": "Markdown"
        }
      },
      "id": "124dc555-c51b-412f-8342-1ed0d1766496",
      "name": "Send to Telegram",
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        8224,
        1120
      ],
      "webhookId": "7a9fabdb-5de8-4144-bdc1-1f15c15412e7",
      "retryOnFail": true,
      "credentials": {
        "telegramApi": {
          "id": "2WYRRJMxfAyshzhn",
          "name": "Telegram account 3"
        }
      }
    },
    {
      "parameters": {
        "resource": "image",
        "operation": "analyze",
        "modelId": {
          "__rl": true,
          "value": "models/gemini-2.5-pro-preview-03-25",
          "mode": "list",
          "cachedResultName": "models/gemini-2.5-pro-preview-03-25"
        },
        "text": "–†–∞—Å–ø–æ–∑–Ω–∞–π –≤–µ—Å—å —Ä—É–∫–æ–ø–∏—Å–Ω—ã–π —Ç–µ–∫—Å—Ç –Ω–∞ —ç—Ç–æ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–∏ –∏ –≤–µ—Ä–Ω–∏ –µ–≥–æ —Ç–æ—á–Ω–æ —Ç–∞–∫, –∫–∞–∫ –Ω–∞–ø–∏—Å–∞–Ω–æ, —Å–æ –≤—Å–µ–º–∏ –æ—à–∏–±–∫–∞–º–∏ –∏ –æ–ø–µ—á–∞—Ç–∫–∞–º–∏.\n\n–í–ê–ñ–ù–û: –û–±—Ä–∞—Ç–∏ –æ—Å–æ–±–æ–µ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ —Ä–∞–∑–ª–∏—á–∏–µ –º–µ–∂–¥—É —Ä—É—Å—Å–∫–∏–º–∏ –±—É–∫–≤–∞–º–∏:\n- –´ (—ã) - –±—É–∫–≤–∞ —Å —Ç–≤—ë—Ä–¥—ã–º –∑–Ω–∞–∫–æ–º, —á–∞—Å—Ç–æ –≤—ã–≥–ª—è–¥–∏—Ç –∫–∞–∫ \"bl\" –∏–ª–∏ –∏–º–µ–µ—Ç —Ö–∞—Ä–∞–∫—Ç–µ—Ä–Ω—É—é —Ñ–æ—Ä–º—É —Å –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ–π —á–µ—Ä—Ç–æ–π –∏ –º—è–≥–∫–∏–º –∑–Ω–∞–∫–æ–º\n- –û (–æ) - –∫—Ä—É–≥–ª–∞—è –±—É–∫–≤–∞\n\n–í–Ω–∏–º–∞—Ç–µ–ª—å–Ω–æ —Ä–∞–∑–ª–∏—á–∞–π —ç—Ç–∏ –±—É–∫–≤—ã –≤ —Ä—É–∫–æ–ø–∏—Å–Ω–æ–º —Ç–µ–∫—Å—Ç–µ. –í–µ—Ä–Ω–∏ —Ç–æ–ª—å–∫–æ —Ç–µ–∫—Å—Ç, –±–µ–∑ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤.",
        "inputType": "binary",
        "binaryPropertyName": "image",
        "options": {}
      },
      "id": "5f61cd06-e614-4070-af06-c49304b845f9",
      "name": "Extract Text with Gemini Vision",
      "type": "@n8n/n8n-nodes-langchain.googleGemini",
      "typeVersion": 1,
      "position": [
        7424,
        1120
      ],
      "credentials": {
        "googlePalmApi": {
          "id": "mmwIOXvHBZDC8uCZ",
          "name": "Google Gemini(PaLM) Api account"
        }
      }
    }
  ],
  "pinData": {},
  "connections": {
    "Upload JPEG Form": {
      "main": [
        [
          {
            "node": "Extract Text with Gemini Vision",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Check and Correct Mistakes": {
      "main": [
        [
          {
            "node": "Format Telegram Message",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Mistral Cloud Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "Check and Correct Mistakes",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Format Telegram Message": {
      "main": [
        [
          {
            "node": "Send to Telegram",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Extract Text with Gemini Vision": {
      "main": [
        [
          {
            "node": "Check and Correct Mistakes",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": false,
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "ccd4857a-3b4d-4f62-8120-8d5149116b67",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "7810ea74e731f275d1deabbe16a84ac67a9362354871a91aacb51e2167f38021"
  },
  "id": "9CVERJNNgRzz4j1O",
  "tags": []
}
